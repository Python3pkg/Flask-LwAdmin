{% import 'macros/actions.html' as actions_macros %}
{% import 'macros/batch_actions.html' as batch_actions_macros %}
{% macro get_list(configuration, pager) -%}
{% if pager.get_nb_results() == 0 or pager.get_results() == None %}
<p>{{ gettext('No result') }}</p>
{% else %}
<table class="table table-hover table-striped">
    <thead>
    <tr>
        {% if batch_actions %}{{ batch_actions_macros.batch_head_row(id='lw_admin_list_batch_checkbox') }}{% endif %}
        <th>Id</th>
        <th>Username</th>
        <th>E-mail</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <th colspan="{% if batch_actions %}5{% else %}4{%  endif %}">{{ get_footer(pager) }}</th>
    </tr>
    </tfoot>
    <tbody>
    {% for item in pager.get_results() %}
    <tr>
        {% if batch_actions %}
        {{ batch_actions_macros.batch_body_row(class='lw_admin_batch_checkbox', value=item.id)}}
        {% endif %}
        <td>{{ item.id }}</td>
        <td>{{ item.username }}</td>
        <td>{{ item.email }}</td>
        <td>
            <div class="btn-group pull-right">
                <a title="Edit" class="btn btn-small" href="{{ url_for('user.user_edit', id=item.id) }}">
                    <i class="icon-edit"></i> Edit
                </a>
                {% if delete_action %}{% if item.username != current_user.get_username() %}
                {{ actions_macros.delete_action(delete_form=delete_action, url=url_for('user.user_del', id=item.id)) }}
                {% endif %}{% endif %}
            </div>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% if pager.have_to_paginate %}{{ get_pager(pager=pager, page=page, url=url_for('user.user_list')) }}{% endif %}
{% if batch_actions %}{{ batch_actions_macros.batch_script(id='lw_admin_list_batch_checkbox', class='lw_admin_batch_checkbox') }}{%  endif %}
{% endif %}
{%- endmacro %}

{% macro get_pager(pager, page, url) -%}
<div class="pagination pagination-centered">
    <ul>
        <li><a href="{{ url }}?page=1" title="{{ gettext('First page') }}"><i class="icon-fast-backward"></i></a></li>
        <li><a href="{{ url }}?page={{ pager.get_previous_page() }}" title="{{ gettext('Previous page') }}"><i class="icon-backward"></i></a></li>
        {% for page in pager.get_links() %}
            {% if page == pager.get_page() %}
        <li class="active disabled"><a href="#">{{ page }}</a></li>
            {% else %}
        <li><a href="{{ url }}?page={{ page }}">{{ page }}</a></li>
            {% endif %}
        {% endfor %}
        <li><a href="{{ url }}?page={{ pager.get_next_page() }}" title="{{ gettext('Next page') }}"><i class="icon-forward"></i></a></li>
        <li><a href="{{ url }}?page={{ pager.get_last_page() }}" title="{{ gettext('Last page') }}"><i class="icon-fast-forward"></i></a></li>
    </ul>
</div>
{%- endmacro %}

{% macro get_footer(pager) -%}
{% if pager.get_nb_results() == 0 %}
{{ gettext('no result') }}
{% else %}
{{ ngettext('result: %(num)d', 'results: %(num)d', pager.get_nb_results())|format(num=pager.get_nb_results()) }}
{% endif %}
{% if pager.have_to_paginate() %}
    {{ gettext('page %(page)s/%(nb_pages)s', page=pager.get_page(), nb_pages=pager.get_last_page()) }}
{% endif %}
{%- endmacro %}
